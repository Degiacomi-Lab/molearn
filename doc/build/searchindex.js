Search.setIndex({"docnames": ["analysis", "data", "index", "loss_functions", "models", "scoring", "trainers"], "filenames": ["analysis.rst", "data.rst", "index.rst", "loss_functions.rst", "models.rst", "scoring.rst", "trainers.rst"], "titles": ["Analysis", "Data Loading", "Welcome to molearn\u2019s documentation!", "Loss Functions", "Models", "Scoring", "Trainers"], "terms": {"loss": [2, 6], "function": [0, 2, 6], "protein": [0, 2, 6], "load": [0, 2, 3, 6], "exampl": [2, 6], "network": [0, 6], "index": [0, 2], "modul": [2, 3, 6], "search": [2, 6], "page": 2, "loss_funct": 6, "alia": 3, "molearn": [0, 6], "from": [1, 2, 3, 4, 6], "c": [1, 3], "user": 0, "xdzl45": [], "workspac": [], "src": [], "__init__": [], "py": [], "loader": [], "hold": [], "class": [0, 1, 3, 6], "data": [0, 2, 3, 6], "model": [0, 2], "trainer": 2, "analysi": 2, "score": [0, 2, 6], "calcul": [0, 3, 6], "openmm": [3, 6], "energi": [0, 3, 6], "backup": [], "method": [0, 3, 6], "just": 3, "pytorch": 6, "dope": 0, "ramachandran": 0, "train": [0, 1, 2, 3, 6], "molearnanalysi": 0, "sourc": [0, 1, 3, 6], "gener": [0, 1, 2, 6], "crd": 0, "collect": 0, "conform": [0, 2], "given": [0, 3, 6], "coordin": 0, "latent": [0, 6], "space": 0, "param": [0, 1, 6], "nx2": 0, "arrai": [0, 6], "return": [0, 1, 3, 6], "cartesian": 0, "nxmx3": 0, "where": [0, 1, 6], "m": 0, "number": [0, 1, 6], "atom": [0, 1, 3, 6], "get_all_dope_scor": 0, "tensor": [0, 1, 3, 6], "refin": 0, "true": [0, 1, 3, 6], "appli": [], "_dope_scor": [], "an": [0, 1, 3, 6], "get_all_ramachandran_scor": 0, "process": [], "1": [0, 1, 6], "_ramachandran_scor": [], "get_dataset": [0, 1], "kei": [0, 6], "paramet": [0, 1, 3, 6], "point": [0, 1], "dataset": [0, 1, 6], "previous": 0, "set_dataset": 0, "structur": [0, 1, 6], "get_decod": 0, "get_dop": 0, "default": [0, 1, 3, 6], "input": [0, 3], "output": [0, 3, 6], "both": [3, 6], "befor": [0, 1, 6], "after": [0, 1, 6], "get_encod": 0, "contain": [0, 1, 6], "encod": [0, 6], "associ": [0, 6], "get_error": 0, "align": 0, "fals": [0, 1, 3, 6], "reconstruct": 0, "error": [0, 3, 6], "decod": [0, 6], "neural": 0, "rmsd": 0, "find": [0, 3, 6], "optim": [0, 6], "between": [0, 6], "1d": 0, "counterpart": 0, "get_ramachandran": 0, "reference_dope_scor": 0, "frame": [0, 1, 6], "numpi": [0, 6], "shape": [0, 3, 6], "n": [0, 1, 3], "3": [0, 3, 6], "scan_custom": 0, "fct": 0, "f": [0, 6], "take": [0, 6], "option": [0, 6], "list": [0, 1, 3, 6], "singl": [0, 6], "valu": [0, 3, 6], "pass": [0, 3, 6], "label": 0, "name": [0, 1], "thi": [0, 1, 2, 3, 6], "scan": 0, "sampl": [0, 6], "grid": 0, "accord": 0, "provid": [0, 2], "x": [0, 3], "y": 0, "ax": [], "scan_error": 0, "64": 0, "boundari": 0, "ar": [0, 1, 3, 6], "defin": [0, 2, 3, 6], "set": [1, 6], "project": [], "extrema": [], "plu": [], "minu": [], "10": [0, 6], "scan_error_from_target": 0, "none": [0, 1, 3, 6], "experiment": [], "creat": [0, 1, 3, 6], "colour": 0, "landscap": 0, "vs": 0, "target": 0, "should": [0, 3, 6], "stuctur": [], "via": [0, 2, 6], "load_test": [], "correspond": [1, 3, 6], "multipl": [1, 6], "requir": [0, 3, 6], "us": [0, 1, 3, 6], "onli": [1, 3], "one": [3, 6], "atomselect": [0, 1], "pdbdata": [0, 1, 6], "object": [0, 1, 3, 6], "string": [0, 1, 3], "set_decod": 0, "set_encod": 0, "coord": 0, "setup_grid": 0, "bounds_from": 0, "bound": 0, "pad": 0, "0": [0, 1, 3, 6], "size": [0, 6], "build": [0, 2], "str": [0, 1, 6], "all": [0, 1, 3, 6], "tupl": [0, 3], "xmin": 0, "xmax": 0, "ymin": 0, "ymax": 0, "extra": [0, 6], "around": 0, "condit": 0, "ratio": [0, 1], "axi": 0, "dimens": 0, "molearngui": 0, "ma": 0, "button_load_state_ev": [], "check": [], "state": [3, 6], "button_pdb_ev": [], "save": [0, 3, 6], "pdb": [1, 6], "file": [1, 3, 6], "interpol": 6, "shown": [], "3d": [], "view": [], "button_save_state_ev": [], "check_test_ev": [], "chang": [], "control": 6, "displai": [], "test": [], "check_training_ev": [], "drop_background_ev": [], "style": [], "surfac": 0, "drop_path_ev": [], "wai": [], "path": [0, 1, 3], "look": [], "interact_3d": [], "mybox": [], "samplebox": [], "trail": [], "on_click": [], "trace": [], "selector": [], "range_slider_ev": [], "updat": 6, "upon": [], "manipul": [], "rang": [], "slider": [], "trail_update_ev": [], "waypoint": 0, "thei": [], "connect": [], "validation_split": 1, "valid_s": 1, "train_siz": 1, "manual_se": 1, "torch": [1, 3, 6], "valid": [1, 6], "split": 1, "arg": [1, 3, 6], "kwarg": [0, 1, 3, 6], "two": [0, 1], "other": [1, 6], "manual": 1, "seed": 1, "specifi": 1, "spefici": 1, "base": [3, 6], "your": [], "also": [3, 6], "subclass": [3, 6], "can": [1, 3, 6], "allow": [], "nest": [], "them": [3, 6], "tree": [], "you": [3, 6], "assign": [], "submodul": [], "regular": [], "attribut": 3, "import": [1, 6], "nn": [3, 6], "def": [], "self": [1, 6], "super": 6, "conv1": [], "conv2d": [], "20": [], "5": 6, "conv2": [], "forward": 3, "relu": [], "regist": [], "have": [1, 3, 6], "convert": 1, "too": [], "when": 6, "call": [0, 1, 6], "etc": [], "As": 6, "per": [], "abov": [], "parent": [], "must": [0, 1, 3, 6], "made": [], "child": [], "ivar": [], "boolean": 3, "repres": 3, "whether": [3, 6], "evalu": 0, "mode": [3, 6], "vartyp": [], "bool": [0, 3, 6], "new": [3, 6], "plugin": 3, "forc": [3, 6], "The": [3, 6], "intent": 3, "fast": 3, "enough": 3, "abl": 3, "dure": [1, 3, 6], "nb": 3, "current": [3, 6], "torchintegratorplugin": 3, "support": 3, "float": [0, 3, 6], "gpu": 3, "doubl": 3, "cpu": 3, "regularli": 0, "num_trainable_param": 0, "trainabl": 0, "If": [0, 3, 6], "set_network": 0, "ensembl": [0, 2], "spawn": [], "parallel": [], "conrdin": 0, "scan_dop": 0, "system": 0, "prior": 0, "s_kei": 0, "network_rmsd": 0, "z_kei": 0, "network_z_drift": 0, "z": 0, "drift": 0, "sting": [], "nxn": 0, "scan_ramachandran": 0, "s": [0, 3], "refer": [0, 3], "instanc": [0, 3, 6], "ignore_atom": 1, "cut": 1, "out": [1, 6], "interest": 1, "import_pdb": 1, "been": [1, 6], "least": 1, "onc": [1, 6], "no_hydrogen": 1, "fix_termin": 1, "renam": [1, 6], "termin": 1, "oxygen": 1, "ot1": 1, "ot2": 1, "oxt": [], "o": [1, 3], "biobox": [1, 3, 6], "molecul": [1, 3, 6], "get_atominfo": 1, "everi": [1, 6], "line": 1, "residu": [0, 1], "resid": 1, "filenam": [1, 6], "multipdb": 1, "command": 1, "time": [1, 6], "mani": [1, 3, 6], "featur": 1, "same": [1, 6], "prepare_dataset": 1, "normalis": [1, 6], "readi": 1, "get_dataload": [1, 6], "batch_siz": [1, 3, 6], "pin_memori": 1, "dataset_sample_s": 1, "shuffl": 1, "sampler": 1, "util": 1, "dataload": [1, 6], "process_dop": [], "worker": [], "set_global_scor": [], "make": [], "global": [], "variabl": 6, "process_ramachandran": [], "modifiedforcefield": 3, "alternative_residue_nam": 3, "more": 3, "xml": 3, "forcefield": 3, "A": [3, 6], "field": 3, "each": [0, 1, 3, 6], "entri": [3, 6], "mai": [3, 6], "absolut": 3, "rel": [3, 6], "work": 3, "directori": [3, 6], "subdirectori": 3, "built": 3, "open": 3, "like": 3, "read": 3, "which": [3, 6], "openmmpluginscoresoftforcefield": 3, "mol": [3, 6], "platform": 3, "cuda": [3, 6], "ca": [1, 3], "cb": [1, 3], "pldataload": 3, "taken": 3, "neither": 3, "thrown": 3, "data_dir": 3, "variant": 3, "npy": 3, "xml_file": 3, "amber14": 3, "either": [0, 3], "remove_nb": 3, "remov": 3, "nonbondedforc": 3, "customgbforc": 3, "cmmotionremov": 3, "els": [3, 6], "openmmpluginscor": 3, "hi": 3, "hie": 3, "hse": 3, "soft": 3, "execut": 3, "b": 3, "dtype": 3, "devic": [3, 6], "get_energi": 3, "pos_ptr": 3, "force_ptr": 3, "energy_ptr": 3, "n_particl": 3, "data_ptr": 3, "int": [0, 3, 6], "openmmtorchenergyminim": 3, "openmm_clamped_energy_funct": 3, "static": 3, "backward": [3, 6], "ctx": 3, "grad_output": 3, "formula": 3, "differenti": 3, "oper": [3, 6], "automat": [3, 6], "vjp": 3, "overridden": [3, 6], "It": [3, 6], "accept": 3, "context": [3, 6], "first": 3, "argument": [3, 6], "follow": [3, 6], "non": 3, "were": 3, "gradient": [3, 6], "w": 3, "r": 3, "t": 3, "grad": 3, "retriev": [3, 6], "ha": [3, 6], "needs_input_grad": 3, "need": [0, 3, 6], "e": [3, 6], "g": [3, 6], "comput": [3, 6], "clamp": [3, 6], "openmm_energi": [3, 6], "std": [3, 6], "initi": 3, "intern": [3, 6], "share": 3, "scriptmodul": 3, "openmm_energy_funct": 3, "ani": [3, 6], "log_filenam": 6, "log_fil": 6, "dat": 6, "openmm_physics_train": 6, "torch_physics_train": 6, "unrefin": 0, "dope_unrefin": 0, "dope_refin": 0, "minimis": 0, "empti": 0, "dedic": [0, 2], "qualiti": 0, "interact": 0, "visualis": 0, "store": 0, "viewabl": 0, "within": [0, 6], "jupyt": 0, "notebook": 0, "produc": [0, 6], "gui": 0, "priorityqueu": [], "queue": [], "shortest": 0, "algorithm": [], "clear": [], "prioriti": [], "get": 6, "pop": [], "top": [], "element": [], "put": [], "item": [], "add": [0, 6], "get_path": 0, "idx_start": 0, "idx_end": 0, "xval": 0, "yval": 0, "smooth": 0, "weight": [0, 6], "2d": 0, "start": [0, 6], "end": 0, "yield": 0, "actual": 0, "kernel": 0, "run": [0, 6], "averag": [0, 6], "lanscap": 0, "get_path_aggreg": 0, "input_is_index": 0, "chain": 0, "give": [0, 6], "assum": [0, 6], "graph": 0, "otherwis": [0, 1], "oversampl": 0, "pt": 0, "equal": 0, "interv": 0, "mx2": 0, "func": 6, "python": 2, "packag": [2, 6], "streamlin": 2, "implement": [2, 6], "machin": 2, "learn": [2, 6], "obtain": [2, 6], "experi": 2, "molecular": 2, "simul": 2, "tool": 2, "handl": 2, "against": 2, "protocol": [2, 6], "analys": 2, "result": [2, 6], "pleas": [2, 6], "see": [2, 6], "github": 2, "instal": 2, "instruct": 2, "script": 2, "autoencod": [4, 6], "architectur": 4, "deriv": 4, "foldingnet": 4, "dictionari": [0, 6], "its": 0, "lantent": [], "datset": 0, "four": 0, "memori": 0, "ramachandran_favor": 0, "ramachandran_allow": 0, "ramachandran_outli": 0, "ramachandran_tot": 0, "ramachandran_favour": 0, "favour": 0, "select": 1, "No": 1, "templat": 1, "found": 1, "openmm_loss": 1, "altern": [1, 6], "solut": 1, "instead": 1, "determinin": 6, "is_avail": 6, "default_log_filenam": 6, "json": 6, "log": 6, "checkpoint": 6, "epoch": 6, "valid_log": 6, "checkpoint_fold": 6, "loss_kei": 6, "valid_loss": 6, "last": 6, "ckpt": 6, "better": 6, "than": 6, "best": 6, "replac": 6, "checkpoint_epoch": 6, "_loss": 6, "former": 6, "best_nam": 6, "delet": 6, "usual": 6, "dict": 6, "folder": 6, "common_step": 6, "batch": 6, "train_step": 6, "valid_step": 6, "mean": 6, "squar": 6, "_intern": 6, "under": 6, "respect": 6, "wish": 6, "elsewher": 6, "mini": 6, "To": 6, "recov": 6, "origin": 6, "mse_loss": 6, "get_network_summari": 6, "inform": 6, "about": 6, "learning_rate_sweep": 6, "max_lr": 6, "100": 6, "min_lr": 6, "1e": 6, "05": 6, "number_of_iter": 6, "1000": 6, "checkpoint_sweep": 6, "train_on": 6, "deprec": 6, "perform": 6, "sweep": 6, "rate": 6, "over": 6, "good": 6, "One": 6, "cycl": 6, "polici": 6, "final": 6, "maximum": 6, "step": 6, "what": 6, "np": [], "ndarrai": 6, "len": 6, "min": 6, "iter": 6, "nan": 6, "word": 6, "load_checkpoint": 6, "checkpoint_nam": 6, "load_optimis": 6, "begin": 6, "checkpoint_": 6, "extract": 6, "charact": 6, "lowest": 6, "we": 6, "whithin": 6, "optimis": 6, "log_dict": 6, "verbos": 6, "Then": 6, "content": 6, "dump": 6, "print": 6, "append": 6, "prepare_optimis": 6, "lr": 6, "001": 6, "weight_decai": 6, "0001": 6, "optimiser_kwarg": 6, "adamw": 6, "With": 6, "do": 6, "adaww": 6, "onto": 6, "max_epoch": 6, "log_fold": 6, "checkpoint_frequ": 6, "allow_n_failur": 6, "loop": 6, "train_epoch": 6, "valid_epoch": 6, "scheduler_step": 6, "until": 6, "match": 6, "alreadi": 6, "exist": 6, "frequenc": 6, "lower": 6, "divis": 6, "how": 6, "restart": 6, "try": 6, "except": 6, "block": 6, "rais": 6, "continu": 6, "well": 6, "written": 6, "doe": 6, "noth": 6, "design": 6, "schedul": 6, "set_autoencod": 6, "initialis": 6, "set_data": 6, "up": 6, "access": 6, "train_dataload": 6, "valid_dataload": 6, "set_dataload": 6, "typic": 6, "zero": 6, "zero_grad": 6, "determin": 6, "keyword": 6, "aggreg": 6, "train_": 6, "prepend": 6, "howev": 6, "These": 6, "update_optimiser_hyperparamet": 6, "optimes": 6, "hyperparamet": 6, "1e3": 6, "pair": 6, "insert": 6, "no_grad": 6, "eval": 6, "valid_": 6, "_autoencoder_kwarg": 6, "standard": 6, "deviat": 6, "unscal": 6, "being": 6, "temporari": 6, "thirdparti": 6, "_data": 6, "type": 6, "physics_loss": 6, "addit": 6, "prepare_phys": 6, "common_physics_step": 6, "random": 6, "adjac": 6, "vector": 6, "term": 6, "n_atom": 6, "2": 6, "physics_scaling_factor": 6, "clamp_threshold": 6, "100000000": 6, "start_physics_at": 6, "scale": 6, "factor": 6, "psf": 6, "8": 6, "yet": 6, "unus": 6, "adit": 6, "overrid": 6, "physic": 6, "sum": 6, "mathemat": 6, "cancel": 6, "becaus": 6, "manag": 6, "essenti": 6, "arbitari": 6, "case": 6, "simpli": 6, "happen": 6, "exactli": 6, "proport": 6, "ration": 6, "differ": 6, "final_loss": 6, "bond": 6, "angl": 6, "torsion": 6, "torchproteinenergi": 6, "indic": 0}, "objects": {"molearn.analysis": [[0, 0, 1, "", "MolearnAnalysis"], [0, 0, 1, "", "MolearnGUI"], [0, 2, 0, "-", "path"]], "molearn.analysis.MolearnAnalysis": [[0, 1, 1, "", "generate"], [0, 1, 1, "", "get_all_dope_score"], [0, 1, 1, "", "get_all_ramachandran_score"], [0, 1, 1, "", "get_dataset"], [0, 1, 1, "", "get_decoded"], [0, 1, 1, "", "get_dope"], [0, 1, 1, "", "get_encoded"], [0, 1, 1, "", "get_error"], [0, 1, 1, "", "get_ramachandran"], [0, 1, 1, "", "num_trainable_params"], [0, 1, 1, "", "reference_dope_score"], [0, 1, 1, "", "scan_custom"], [0, 1, 1, "", "scan_dope"], [0, 1, 1, "", "scan_error"], [0, 1, 1, "", "scan_error_from_target"], [0, 1, 1, "", "scan_ramachandran"], [0, 1, 1, "", "set_dataset"], [0, 1, 1, "", "set_decoded"], [0, 1, 1, "", "set_encoded"], [0, 1, 1, "", "set_network"], [0, 1, 1, "", "setup_grid"]], "molearn.analysis.path": [[0, 3, 1, "", "get_path"], [0, 3, 1, "", "get_path_aggregate"], [0, 3, 1, "", "oversample"]], "molearn.data": [[1, 0, 1, "", "PDBData"]], "molearn.data.PDBData": [[1, 1, 1, "", "atomselect"], [1, 1, 1, "", "fix_terminal"], [1, 1, 1, "", "frame"], [1, 1, 1, "", "get_atominfo"], [1, 1, 1, "", "get_dataloader"], [1, 1, 1, "", "get_datasets"], [1, 1, 1, "", "import_pdb"], [1, 1, 1, "", "prepare_dataset"], [1, 1, 1, "", "split"]], "molearn.loss_functions": [[3, 2, 0, "-", "openmm_thread"], [3, 2, 0, "-", "torch_protein_energy"]], "molearn.loss_functions.openmm_thread": [[3, 0, 1, "", "ModifiedForceField"], [3, 0, 1, "", "OpenMMPluginScoreSoftForceField"], [3, 0, 1, "", "OpenmmPluginScore"], [3, 0, 1, "", "OpenmmTorchEnergyMinimizer"], [3, 0, 1, "", "openmm_clamped_energy_function"], [3, 0, 1, "", "openmm_energy"], [3, 0, 1, "", "openmm_energy_function"]], "molearn.loss_functions.openmm_thread.OpenmmPluginScore": [[3, 1, 1, "", "execute"], [3, 1, 1, "", "get_energy"]], "molearn.loss_functions.openmm_thread.openmm_clamped_energy_function": [[3, 1, 1, "", "backward"], [3, 1, 1, "", "forward"]], "molearn.loss_functions.openmm_thread.openmm_energy_function": [[3, 1, 1, "", "backward"], [3, 1, 1, "", "forward"]], "molearn.models.foldingnet": [[4, 2, 0, "-", "AutoEncoder"]], "molearn.scoring": [[5, 2, 0, "-", "DOPE_Score"], [5, 2, 0, "-", "Parallel_DOPE_Score"], [5, 2, 0, "-", "Parallel_Ramachandran_Score"], [5, 2, 0, "-", "Ramachandran_Score"]], "molearn.trainers.openmm_physics_trainer": [[6, 0, 1, "", "OpenMM_Physics_Trainer"]], "molearn.trainers.openmm_physics_trainer.OpenMM_Physics_Trainer": [[6, 1, 1, "", "common_physics_step"], [6, 1, 1, "", "prepare_physics"], [6, 1, 1, "", "train_step"], [6, 1, 1, "", "valid_step"]], "molearn.trainers.torch_physics_trainer": [[6, 0, 1, "", "Torch_Physics_Trainer"]], "molearn.trainers.torch_physics_trainer.Torch_Physics_Trainer": [[6, 1, 1, "", "common_physics_step"], [6, 1, 1, "", "prepare_physics"], [6, 1, 1, "", "train_step"], [6, 1, 1, "", "valid_step"]], "molearn.trainers.trainer": [[6, 0, 1, "", "Trainer"]], "molearn.trainers.trainer.Trainer": [[6, 1, 1, "", "checkpoint"], [6, 1, 1, "", "common_step"], [6, 1, 1, "", "get_network_summary"], [6, 1, 1, "", "learning_rate_sweep"], [6, 1, 1, "", "load_checkpoint"], [6, 1, 1, "", "log"], [6, 1, 1, "", "prepare_optimiser"], [6, 1, 1, "", "run"], [6, 1, 1, "", "scheduler_step"], [6, 1, 1, "", "set_autoencoder"], [6, 1, 1, "", "set_data"], [6, 1, 1, "", "set_dataloader"], [6, 1, 1, "", "train_epoch"], [6, 1, 1, "", "train_step"], [6, 1, 1, "", "update_optimiser_hyperparameters"], [6, 1, 1, "", "valid_epoch"], [6, 1, 1, "", "valid_step"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:module", "3": "py:function"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "module", "Python module"], "3": ["py", "function", "Python function"]}, "titleterms": {"welcom": 2, "molearn": 2, "s": 2, "document": 2, "content": 2, "indic": 2, "tabl": 2, "loss": 3, "function": 3, "protein": [], "load": 1, "exampl": [], "network": [], "analysi": 0, "model": 4, "score": 5, "trainer": 6, "data": 1}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})